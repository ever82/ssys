/*
 * Picker Plugin
 * @author Ben Plum
 * @version 0.4.0
 *
 * Copyright Â© 2013 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
 
if(jQuery)(function(e){function n(a){a=e.extend({},p,a);for(var d=e(this),b=0,c=d.length;b<c;b++){var g=d.eq(b),f=a;if(!g.data("picker")){var f=e.extend({},f,g.data("picker-options")),q=e("label[for="+g.attr("id")+"]"),k=g.attr("type"),h="picker-"+("radio"==k?"radio":"checkbox"),m=g.attr("name"),l='<div class="picker-handle"><div class="picker-flag" /></div>';f.toggle&&(h+=" picker-toggle",l='<span class="picker-toggle-label on">'+f.labelOn+'</span><span class="picker-toggle-label off">'+f.labelOff+"</span>"+ l);g.addClass("picker-element");q.wrap('<div class="picker '+h+" "+f.customClass+'" />').before(l).addClass("picker-label");var h=q.parents(".picker"),l=h.find(".picker-handle"),n=h.find(".picker-toggle-label");g.is(":checked")&&h.addClass("checked");g.is(":disabled")&&h.addClass("disabled");e.extend(f,{$picker:h,$input:g,$handle:l,$label:q,$labels:n,group:m,isRadio:"radio"==k,isCheckbox:"checkbox"==k});g.on("focus.picker",f,s).on("blur.picker",f,t).on("change.picker",f,u).on("deselect.picker",f, r).data("picker",f);h.on("click.picker",f,v)}}return d}function v(a){a.preventDefault();a.stopPropagation();var d=a.data;e(a.target).is(d.$input)||d.$input.trigger("click")}function u(a){a.stopPropagation();var d=a.data;if(!d.$input.is(":disabled")){var b=d.$input.is(":checked");d.isCheckbox?b?k(a,!0):r(a,!0):b&&k(a)}}function k(a,d){var b=a.data;"undefined"!==typeof b.group&&b.isRadio&&e('input[name="'+b.group+'"]').not(b.$input).trigger("deselect");b.$picker.addClass("checked")}function r(a,d){a.data.$picker.removeClass("checked")} function s(a){a.data.$picker.addClass("focus")}function t(a){a.data.$picker.removeClass("focus")}var p={customClass:"",toggle:!1,labelOn:"ON",labelOff:"OFF"},m={defaults:function(a){p=e.extend(p,a||{});return e(this)},disable:function(){return e(this).each(function(a,d){var b=e(d),c=b.data("picker");"undefined"!=typeof c&&(c=c.$picker,b.prop("disabled",!0),c.addClass("disabled"))})},enable:function(){return e(this).each(function(a,d){var b=e(d),c=b.data("picker");"undefined"!=typeof c&&(c=c.$picker, b.prop("disabled",!1),c.removeClass("disabled"))})},destroy:function(){return e(this).each(function(a,d){var b=e(d),c=b.data("picker");if("undefined"!=typeof c){var c=c.$picker,g=c.find(".picker-handle"),f=c.find(".picker-toggle-label"),k=e("label[for="+b.attr("id")+"]");c.off(".picker");g.remove();f.remove();b.off(".picker").removeClass("picker-element").data("picker",null);k.removeClass("picker-label").unwrap()}})},update:function(){return e(this).each(function(a,d){var b=e(d),c=b.data("picker"); "undefined"==typeof c||b.is(":disabled")||(b.is(":checked")?k({data:c},!0):r({data:c},!0))})}};e.fn.picker=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof a&&a?this:n.apply(this,arguments)}})(jQuery);